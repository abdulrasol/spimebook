{% extends "posts/base.html" %}
{% load static %}
{% load posts_extra %}
{% block content %}
<div class="article-feed">
    {% for post in posts %}
    {% post post %}
    {% endfor %}
</div>


<!-- status elements -->
<div class="page-load-status">
    <div class="loader-ellips infinite-scroll-request">
        <div style="display: none;" class="loading-more-post">
            <div class="loading-more-post">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>
</div>
<!-- pagination has path -->


{% if posts.has_next %}
<p class="pagination">
    <a class="pagination__next" href="?page={{ posts.next_page_number }}"></a>
</p>
{% endif %}

{% endblock content %}
{% block javascript %}
<script>
    // init Infinite Scroll
    $('.content-container .article-feed').infiniteScroll({
        path: '.pagination__next',
        append: '.article',
        status: '.scroller-status',
        hideNav: '.pagination',
    });
    var infScroll = $('.article-feed').data('infiniteScroll');

    $('.article-feed').on('scrollThreshold.infiniteScroll', function (event) {
        //console.log('Scroll at bottom');
        $('.loading-more-post').show();
    });
    $('.article-feed').on('append.infiniteScroll', function (event, response, path, items) {
        console.log(items.length + ' items appended');
        $('.loading-more-post').hide();

    });
</script>
{% endblock javascript %}